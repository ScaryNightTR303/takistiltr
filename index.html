<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HızlıAlış - Modern E-Ticaret</title>
  <style>
    /* Temel sıfırlamalar */
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      background: #fff;
      color: #333;
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    header, footer {
      background: #0D47A1;
      color: #fff;
      text-align: center;
      padding: 1.5rem 1rem;
      box-shadow: 0 3px 8px rgba(0,0,0,0.2);
    }
    header h1 {
      margin: 0;
      font-weight: 700;
      font-size: 1.9rem;
      letter-spacing: 2px;
      user-select: none;
    }
    nav {
      margin-top: 10px;
      display: flex;
      justify-content: center;
      gap: 1.2rem;
    }
    nav a {
      color: #fff;
      text-decoration: none;
      font-weight: 600;
      cursor: pointer;
      padding: 8px 16px;
      border-radius: 25px;
      transition: background-color 0.3s ease;
      user-select: none;
    }
    nav a:hover {
      background-color: #1565c0;
    }
    nav a.hidden {
      display: none !important;
    }

    main {
      flex: 1;
      max-width: 960px;
      margin: 2rem auto 3rem;
      padding: 1rem 1.5rem;
    }

    /* Form ve bölümler */
    section {
      max-width: 480px;
      margin: auto;
      padding: 1.5rem 1.5rem 2rem;
      background: #f9f9f9;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(13,71,161,0.15);
    }
    section.hidden {
      display: none;
    }

    h2 {
      font-weight: 700;
      color: #0D47A1;
      margin-bottom: 1rem;
      text-align: center;
      letter-spacing: 1px;
    }

    input[type=text],
    input[type=password],
    input[type=number],
    select {
      width: 100%;
      padding: 12px 14px;
      margin-bottom: 1rem;
      border: 2px solid #bbdefb;
      border-radius: 8px;
      font-size: 1rem;
      transition: border-color 0.3s ease;
      outline-offset: 0;
    }
    input[type=text]:focus,
    input[type=password]:focus,
    input[type=number]:focus,
    select:focus {
      border-color: #0D47A1;
      outline: none;
    }

    button {
      width: 100%;
      background-color: #0D47A1;
      color: white;
      border: none;
      padding: 14px;
      border-radius: 30px;
      font-size: 1.1rem;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 5px 12px rgba(13,71,161,0.4);
      transition: background-color 0.3s ease;
      user-select: none;
    }
    button:hover {
      background-color: #1565c0;
    }

    /* Mesajlar */
    #message {
      text-align: center;
      margin: 0.8rem 0 1.5rem;
      font-weight: 600;
      height: 1.2rem;
      color: #e53935;
      user-select: none;
    }
    #message.success {
      color: #388e3c;
    }

    /* Kullanıcı paneli */
    #userPanel {
      max-width: 720px;
      margin: auto;
      padding: 1rem 1.5rem 2rem;
      background: #f0f4ff;
      border-radius: 14px;
      box-shadow: 0 6px 18px rgba(13,71,161,0.2);
    }
    #userPanel > p {
      text-align: center;
      font-weight: 600;
      margin-bottom: 1rem;
      user-select: none;
    }
    #balance {
      font-size: 1.3rem;
      margin-bottom: 1.5rem;
      color: #0D47A1;
      text-align: center;
      font-weight: 700;
    }

    #orderForm {
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 2rem;
    }
    #orderForm select, #orderForm input[type=number] {
      flex: 1 1 140px;
      min-width: 140px;
    }
    #orderForm button {
      flex: 1 1 120px;
      min-width: 120px;
    }

    /* Sipariş listeleri */
    #orders {
      display: flex;
      gap: 2rem;
      flex-wrap: wrap;
      justify-content: center;
    }
    .orderList {
      flex: 1 1 320px;
      background: white;
      padding: 1rem;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .orderList h3 {
      margin-top: 0;
      color: #0D47A1;
      text-align: center;
      font-weight: 700;
    }
    .orderItem {
      background: #f0f4ff;
      border-left: 6px solid #0D47A1;
      margin: 0.8rem 0;
      padding: 10px 14px;
      border-radius: 8px;
      user-select: none;
    }
    .orderItem.delivered {
      border-left-color: #4caf50;
      background: #e8f9e8;
    }
    .orderItem.cancelled {
      border-left-color: #f44336;
      background: #fbe9e9;
      text-decoration: line-through;
      color: #b71c1c;
    }

    /* Admin panel */
    #adminPanel {
      max-width: 960px;
      margin: auto;
      background: #fff;
      border-radius: 12px;
      padding: 1.5rem 2rem;
      box-shadow: 0 6px 20px rgba(13,71,161,0.25);
    }
    #adminPanel h2 {
      color: #0D47A1;
      text-align: center;
      margin-bottom: 1rem;
    }
    #adminUsersTable {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 2rem;
    }
    #adminUsersTable th, #adminUsersTable td {
      padding: 10px 12px;
      border-bottom: 1px solid #ccc;
      text-align: left;
      vertical-align: middle;
    }
    #adminUsersTable th {
      background-color: #0D47A1;
      color: white;
      font-weight: 600;
      user-select: none;
    }
    #adminUsersTable td input[type=number] {
      width: 80px;
      padding: 5px;
      border-radius: 6px;
      border: 1px solid #90caf9;
      font-size: 1rem;
      transition: border-color 0.3s ease;
    }
    #adminUsersTable td input[type=number]:focus {
      border-color: #0D47A1;
      outline: none;
    }
    #adminOrderList {
      max-height: 380px;
      overflow-y: auto;
    }
    .adminOrderItem {
      background: #f0f4ff;
      border-left: 6px solid #0D47A1;
      margin: 0.7rem 0;
      padding: 10px 14px;
      border-radius: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      user-select: none;
    }
    .adminOrderItem select {
      padding: 6px 8px;
      border-radius: 6px;
      border: 1.5px solid #90caf9;
      font-size: 1rem;
      cursor: pointer;
      transition: border-color 0.3s ease;
    }
    .adminOrderItem select:focus {
      border-color: #0D47A1;
      outline: none;
    }

    /* Responsive */
    @media (max-width: 720px) {
      #orderForm {
        flex-direction: column;
      }
      #orderForm select, #orderForm input[type=number], #orderForm button {
        flex: unset;
        width: 100%;
        min-width: unset;
      }
      #orders {
        flex-direction: column;
      }
      .orderList {
        flex: unset;
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>HızlıAlış</h1>
    <nav>
      <a id="navLogin" onclick="showAuthSection('login')">Giriş Yap</a>
      <a id="navRegister" onclick="showAuthSection('register')">Kayıt Ol</a>
      <a id="navLogout" class="hidden" onclick="logout()">Çıkış Yap</a>
      <a id="navAdminPanel" class="hidden" onclick="showAdminPanel()">Admin Paneli</a>
      <span id="navWelcome" class="hidden" style="color:#fff; margin-left:15px; user-select:none;"></span>
    </nav>
  </header>

  <main>
    <!-- Giriş ve Kayıt alanı -->
    <section id="authSection">
      <div id="loginForm">
        <h2>Giriş Yap</h2>
        <input type="text" id="loginUsername" placeholder="Kullanıcı Adı" autocomplete="username" />
        <input type="password" id="loginPassword" placeholder="Şifre" autocomplete="current-password" />
        <button onclick="login()">Giriş Yap</button>
      </div>
      <div id="registerForm" class="hidden">
        <h2>Kayıt Ol</h2>
        <input type="text" id="registerUsername" placeholder="Kullanıcı Adı" autocomplete="username" />
        <input type="password" id="registerPassword" placeholder="Şifre" autocomplete="new-password" />
        <input type="text" id="registerAddress" placeholder="Adres" />
        <button onclick="register()">Kayıt Ol</button>
      </div>
      <p id="message"></p>
    </section>

    <!-- Kullanıcı Paneli -->
    <section id="userPanel" class="hidden">
      <p>Hoşgeldiniz, <b><span id="userNameDisplay"></span></b>!</p>
      <div id="balance">Bakiyeniz: 0 TL</div>
      <div id="orderForm">
        <select id="productSelect" aria-label="Ürün seçimi">
          <option value="Telefon" data-price="15000">Telefon - 15.000 TL</option>
          <option value="Kulaklık" data-price="500">Kulaklık - 500 TL</option>
          <option value="Klavye" data-price="1000">Klavye - 1.000 TL</option>
          <option value="Mouse" data-price="700">Mouse - 700 TL</option>
          <option value="Monitör" data-price="4500">Monitör - 4.500 TL</option>
          <option value="USB Bellek" data-price="150">USB Bellek - 150 TL</option>
          <option value="Powerbank" data-price="800">Powerbank - 800 TL</option>
          <option value="Web Kamera" data-price="1200">Web Kamera - 1.200 TL</option>
          <option value="Hoparlör" data-price="950">Hoparlör - 950 TL</option>
          <option value="Tablet" data-price="9000">Tablet - 9.000 TL</option>
        </select>
        <input type="number" id="productQuantity" min="1" value="1" aria-label="Adet" />
        <button onclick="createOrder()">Sipariş Ver</button>
      </div>

      <div id="orders">
        <div class="orderList">
          <h3>Aktif Siparişler</h3>
          <div id="activeOrders"></div>
        </div>
        <div class="orderList">
          <h3>Geçmiş Siparişler</h3>
          <div id="pastOrders"></div>
        </div>
      </div>
    </section>

    <!-- Admin Paneli -->
    <section id="adminPanel" class="hidden">
      <h2>Admin Paneli</h2>
      <p style="text-align:center; font-weight:600; margin-bottom:1rem;">Hoşgeldiniz, Admin!</p>

      <table id="adminUsersTable">
        <thead>
          <tr>
            <th>Kullanıcı</th>
            <th>Bakiye (TL)</th>
            <th>Adres</th>
            <th>İşlemler</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <h3>Seçili Kullanıcının Siparişleri: <span id="adminSelectedUser"></span></h3>
      <div id="adminOrderList"></div>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 HızlıAlış</p>
  </footer>

  <script>
    // Veri yapıları
    let users = JSON.parse(localStorage.getItem('users')) || { admin: 'admin1212' };
    let balances = JSON.parse(localStorage.getItem('balances')) || { admin: 0 };
    let addresses = JSON.parse(localStorage.getItem('addresses')) || { admin: '' };
    let orders = JSON.parse(localStorage.getItem('orders')) || { admin: [] };
    let orderStatuses = JSON.parse(localStorage.getItem('orderStatuses')) || { admin: [] };

    let currentUser = null;
    let adminSelectedUser = null;

    const navLogin = document.getElementById('navLogin');
    const navRegister = document.getElementById('navRegister');
    const navLogout = document.getElementById('navLogout');
    const navAdminPanel = document.getElementById('navAdminPanel');
    const navWelcome = document.getElementById('navWelcome');

    const authSection = document.getElementById('authSection');
    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');
    const messageEl = document.getElementById('message');

    const userPanel = document.getElementById('userPanel');
    const userNameDisplay = document.getElementById('userNameDisplay');
    const balanceDisplay = document.getElementById('balance');
    const productSelect = document.getElementById('productSelect');
    const productQuantity = document.getElementById('productQuantity');
    const activeOrdersDiv = document.getElementById('activeOrders');
    const pastOrdersDiv = document.getElementById('pastOrders');

    const adminPanel = document.getElementById('adminPanel');
    const adminUsersTableBody = document.querySelector('#adminUsersTable tbody');
    const adminSelectedUserSpan = document.getElementById('adminSelectedUser');
    const adminOrderListDiv = document.getElementById('adminOrderList');

    // LocalStorage'a kaydet
    function saveData() {
      localStorage.setItem('users', JSON.stringify(users));
      localStorage.setItem('balances', JSON.stringify(balances));
      localStorage.setItem('addresses', JSON.stringify(addresses));
      localStorage.setItem('orders', JSON.stringify(orders));
      localStorage.setItem('orderStatuses', JSON.stringify(orderStatuses));
    }

    // Navigasyon güncelle
    function updateNav() {
      if (currentUser === 'admin') {
        navLogin.classList.add('hidden');
        navRegister.classList.add('hidden');
        navLogout.classList.remove('hidden');
        navAdminPanel.classList.remove('hidden');
        navWelcome.textContent = `Hoşgeldiniz, ${currentUser}`;
        navWelcome.classList.remove('hidden');
      } else if (currentUser) {
        navLogin.classList.add('hidden');
        navRegister.classList.add('hidden');
        navLogout.classList.remove('hidden');
        navAdminPanel.classList.add('hidden');
        navWelcome.textContent = `Hoşgeldiniz, ${currentUser}`;
        navWelcome.classList.remove('hidden');
      } else {
        navLogin.classList.remove('hidden');
        navRegister.classList.remove('hidden');
        navLogout.classList.add('hidden');
        navAdminPanel.classList.add('hidden');
        navWelcome.classList.add('hidden');
        navWelcome.textContent = '';
      }
    }

    // Giriş/Kayıt bölümleri arasında geçiş
    function showAuthSection(section) {
      messageEl.textContent = '';
      if (section === 'login') {
        loginForm.classList.remove('hidden');
        registerForm.classList.add('hidden');
      } else {
        loginForm.classList.add('hidden');
        registerForm.classList.remove('hidden');
      }
      authSection.classList.remove('hidden');
      userPanel.classList.add('hidden');
      adminPanel.classList.add('hidden');
    }

    // Kayıt olma
    function register() {
      const username = document.getElementById('registerUsername').value.trim();
      const password = document.getElementById('registerPassword').value;
      const address = document.getElementById('registerAddress').value.trim();

      if (!username || !password || !address) {
        messageEl.textContent = 'Lütfen tüm alanları doldurun.';
        messageEl.className = '';
        return;
      }
      if (users[username]) {
        messageEl.textContent = 'Bu kullanıcı adı zaten alınmış.';
        messageEl.className = '';
        return;
      }
      users[username] = password;
      balances[username] = 10000; // Başlangıç bakiyesi 10.000 TL
      addresses[username] = address;
      orders[username] = [];
      orderStatuses[username] = [];

      saveData();
      messageEl.textContent = 'Kayıt başarılı! Giriş yapabilirsiniz.';
      messageEl.className = 'success';

      // Temizle
      document.getElementById('registerUsername').value = '';
      document.getElementById('registerPassword').value = '';
      document.getElementById('registerAddress').value = '';
    }

    // Giriş yapma
    function login() {
      const username = document.getElementById('loginUsername').value.trim();
      const password = document.getElementById('loginPassword').value;

      if (!username || !password) {
        messageEl.textContent = 'Lütfen kullanıcı adı ve şifre girin.';
        messageEl.className = '';
        return;
      }
      if (users[username] !== password) {
        messageEl.textContent = 'Kullanıcı adı veya şifre yanlış.';
        messageEl.className = '';
        return;
      }

      currentUser = username;
      updateNav();
      messageEl.textContent = '';
      showUserPanel();
      loadUserData();
    }

    // Çıkış yap
    function logout() {
      currentUser = null;
      adminSelectedUser = null;
      updateNav();
      showAuthSection('login');
    }

    // Kullanıcı panelini göster
    function showUserPanel() {
      authSection.classList.add('hidden');
      userPanel.classList.remove('hidden');
      adminPanel.classList.add('hidden');

      userNameDisplay.textContent = currentUser;
      updateBalance();
      showOrders();
    }

    // Bakiye güncelle
    function updateBalance() {
      balanceDisplay.textContent = `Bakiyeniz: ${balances[currentUser]} TL`;
    }

    // Sipariş oluşturma
    function createOrder() {
      const product = productSelect.value;
      const price = parseFloat(productSelect.selectedOptions[0].getAttribute('data-price'));
      let quantity = parseInt(productQuantity.value);

      if (isNaN(quantity) || quantity < 1) quantity = 1;

      const totalPrice = price * quantity;

      if (balances[currentUser] < totalPrice) {
        alert('Yetersiz bakiye!');
        return;
      }

      // Sipariş detayı
      const detail = `${product} x${quantity} (Toplam: ${totalPrice} TL)`;

      balances[currentUser] -= totalPrice;
      orders[currentUser].push(detail);
      orderStatuses[currentUser].push('Sipariş Alındı');

      saveData();
      updateBalance();
      showOrders();

      alert('Siparişiniz alındı. Teşekkürler!');
      productQuantity.value = 1;
    }

    // Siparişleri göster
    function showOrders() {
      activeOrdersDiv.innerHTML = '';
      pastOrdersDiv.innerHTML = '';

      const userOrders = orders[currentUser] || [];
      const userStatuses = orderStatuses[currentUser] || [];

      userOrders.forEach((order, i) => {
        const status = userStatuses[i];
        const div = document.createElement('div');
        div.className = 'orderItem';

        if (status === 'Teslim Edildi') {
          div.classList.add('delivered');
          pastOrdersDiv.appendChild(div);
        } else if (status === 'İptal Edildi') {
          div.classList.add('cancelled');
          pastOrdersDiv.appendChild(div);
        } else {
          activeOrdersDiv.appendChild(div);
        }

        div.textContent = `${order} | Durum: ${status}`;
      });
    }

    // Admin panel göster
    function showAdminPanel() {
      if (currentUser !== 'admin') return alert('Admin erişimi için giriş yapmalısınız.');

      authSection.classList.add('hidden');
      userPanel.classList.add('hidden');
      adminPanel.classList.remove('hidden');

      loadAdminUsers();
      adminSelectedUser = null;
      adminSelectedUserSpan.textContent = '';
      adminOrderListDiv.innerHTML = '';
    }

    // Admin - Kullanıcı listesini yükle
    function loadAdminUsers() {
      adminUsersTableBody.innerHTML = '';

      Object.keys(users).forEach(user => {
        if (user === 'admin') return; // Admin hariç

        const tr = document.createElement('tr');

        const tdUser = document.createElement('td');
        tdUser.textContent = user;

        const tdBalance = document.createElement('td');
        const balanceInput = document.createElement('input');
        balanceInput.type = 'number';
        balanceInput.min = 0;
        balanceInput.value = balances[user];
        balanceInput.onchange = () => {
          const val = parseInt(balanceInput.value);
          if (!isNaN(val) && val >= 0) {
            balances[user] = val;
            saveData();
            if (currentUser === user) updateBalance();
          } else {
            balanceInput.value = balances[user];
          }
        };
        tdBalance.appendChild(balanceInput);

        const tdAddress = document.createElement('td');
        tdAddress.textContent = addresses[user];

        const tdActions = document.createElement('td');
        const viewOrdersBtn = document.createElement('button');
        viewOrdersBtn.textContent = 'Siparişleri Gör';
        viewOrdersBtn.style.padding = '6px 12px';
        viewOrdersBtn.style.border = 'none';
        viewOrdersBtn.style.borderRadius = '6px';
        viewOrdersBtn.style.background = '#0D47A1';
        viewOrdersBtn.style.color = '#fff';
        viewOrdersBtn.style.cursor = 'pointer';
        viewOrdersBtn.onclick = () => {
          adminSelectedUser = user;
          adminSelectedUserSpan.textContent = user;
          loadAdminUserOrders(user);
        };
        tdActions.appendChild(viewOrdersBtn);

        tr.appendChild(tdUser);
        tr.appendChild(tdBalance);
        tr.appendChild(tdAddress);
        tr.appendChild(tdActions);

        adminUsersTableBody.appendChild(tr);
      });
    }

    // Admin - Kullanıcı siparişlerini yükle
    function loadAdminUserOrders(user) {
      adminOrderListDiv.innerHTML = '';

      const userOrders = orders[user] || [];
      const userStatuses = orderStatuses[user] || [];

      if (userOrders.length === 0) {
        adminOrderListDiv.textContent = 'Sipariş bulunamadı.';
        return;
      }

      userOrders.forEach((order, i) => {
        const div = document.createElement('div');
        div.className = 'adminOrderItem';

        const span = document.createElement('span');
        span.textContent = order;

        const select = document.createElement('select');
        ['Sipariş Alındı', 'Hazırlanıyor', 'Kargoda', 'Teslim Edildi', 'İptal Edildi'].forEach(status => {
          const option = document.createElement('option');
          option.value = status;
          option.textContent = status;
          if (status === userStatuses[i]) option.selected = true;
          select.appendChild(option);
        });

        select.onchange = () => {
          orderStatuses[user][i] = select.value;
          saveData();
          showOrders();
        };

        div.appendChild(span);
        div.appendChild(select);
        adminOrderListDiv.appendChild(div);
      });
    }

    // Sayfa yüklendiğinde otomatik admin hesabı oluştur
    function initializeAdmin() {
      let changed = false;
      if (!users['admin']) {
        users['admin'] = 'admin1212';
        balances['admin'] = 0;
        addresses['admin'] = '';
        orders['admin'] = [];
        orderStatuses['admin'] = [];
        changed = true;
      }
      if (changed) saveData();
    }

    // Sayfa yüklendiğinde
    window.onload = () => {
      initializeAdmin();
      updateNav();
      showAuthSection('login');
    };
  </script>
</body>
</html>
