<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MottoTrend Klon E-Ticaret</title>
<style>
  /* Reset & genel ayarlar */
  * {
    box-sizing: border-box;
  }
  body {
    margin:0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:#f9f9f9; min-height:100vh; display:flex; flex-direction:column;
  }
  a {
    color:#e60023; text-decoration:none;
  }
  a:hover {
    text-decoration:underline;
  }
  button {
    cursor:pointer;
  }

  /* HEADER */
  header {
    background: #fff;
    padding: 10px 20px;
    display: flex;
    justify-content: flex-end;
    align-items: center;
    gap: 20px;
    border-bottom: 1px solid #ddd;
    position: sticky;
    top:0;
    z-index: 99;
  }
  header button {
    background: #e60023;
    border:none;
    color:#fff;
    font-weight: 600;
    padding: 10px 18px;
    border-radius: 5px;
    transition: background-color 0.3s ease;
  }
  header button:hover {
    background: #b00018;
  }
  #cartBtn {
    position: relative;
  }
  #cartCount {
    position: absolute;
    top: -6px;
    right: -8px;
    background: yellow;
    color: #000;
    border-radius: 50%;
    padding: 2px 6px;
    font-size: 12px;
    font-weight: 700;
  }

  /* ÜRÜNLER KISMI */
  main {
    flex:1;
    padding: 20px;
    max-width: 1200px;
    margin: 0 auto;
    width: 100%;
  }
  #productsContainer {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    justify-content: center;
  }
  .product-card {
    background: #fff;
    border-radius: 6px;
    box-shadow: 0 0 6px rgb(0 0 0 / 0.1);
    width: 220px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    overflow: hidden;
    transition: transform 0.3s ease;
  }
  .product-card:hover {
    transform: scale(1.03);
  }
  .product-card img {
    width: 100%;
    height: 160px;
    object-fit: contain;
    background: #f0f0f0;
  }
  .product-info {
    padding: 12px 15px 18px 15px;
    display: flex;
    flex-direction: column;
    gap: 6px;
  }
  .product-title {
    font-weight: 600;
    font-size: 1rem;
    color: #333;
  }
  .product-price {
    color: #e60023;
    font-weight: 700;
    font-size: 1.1rem;
  }
  .add-cart-btn {
    background: #e60023;
    border:none;
    color:#fff;
    font-weight: 700;
    padding: 8px 0;
    border-radius: 5px;
    margin-top: 10px;
    font-size: 0.95rem;
    transition: background-color 0.3s ease;
  }
  .add-cart-btn:hover {
    background: #b00018;
  }

  /* MODAL GENEL */
  .modal-bg {
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: rgba(0,0,0,0.6);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 999;
  }
  .modal-bg.active {
    display: flex;
  }
  .modal {
    background:#fff;
    border-radius: 8px;
    max-width: 480px;
    max-height: 90vh;
    overflow-y: auto;
    padding: 20px 25px 30px 25px;
    box-shadow: 0 0 12px rgba(0,0,0,0.3);
    position: relative;
    width: 100%;
  }
  .close-btn {
    position: absolute;
    top: 8px;
    right: 14px;
    font-size: 25px;
    color: #333;
    border: none;
    background: none;
    cursor: pointer;
  }

  /* SEPET MODAL */
  #cartItems {
    max-height: 250px;
    overflow-y: auto;
    margin-bottom: 10px;
  }
  .cart-item {
    display: flex;
    gap: 10px;
    border-bottom: 1px solid #eee;
    padding: 10px 0;
    align-items: center;
  }
  .cart-item img {
    width: 60px;
    height: 60px;
    object-fit: contain;
    background: #f0f0f0;
    border-radius: 4px;
  }
  .cart-item-info {
    flex:1;
  }
  .cart-item-title {
    font-weight: 600;
    font-size: 0.95rem;
    margin-bottom: 6px;
  }
  .cart-item-qty {
    display: flex;
    align-items: center;
    gap: 5px;
  }
  .cart-item-qty button {
    background:#e60023;
    color:#fff;
    border:none;
    border-radius: 4px;
    width: 28px;
    height: 28px;
    font-weight: 700;
    font-size: 18px;
    line-height: 0;
    padding: 0;
  }
  .cart-item-qty span {
    min-width: 22px;
    display: inline-block;
    text-align: center;
    font-weight: 700;
  }
  .remove-btn {
    background:none;
    border:none;
    font-size: 22px;
    font-weight: 700;
    color: #999;
    cursor: pointer;
    transition: color 0.3s ease;
  }
  .remove-btn:hover {
    color: #e60023;
  }
  /* Sipariş form */
  #orderForm label {
    display: block;
    margin-top: 10px;
    font-weight: 600;
    font-size: 0.9rem;
  }
  #orderForm input, #orderForm textarea {
    width: 100%;
    padding: 8px 10px;
    margin-top: 4px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 0.9rem;
    font-family: inherit;
  }
  #orderForm textarea {
    resize: vertical;
  }
  #orderForm button.submit-btn {
    margin-top: 15px;
    background: #e60023;
    color:#fff;
    font-weight: 700;
    border:none;
    border-radius: 5px;
    padding: 12px 0;
    width: 100%;
    font-size: 1rem;
  }
  #orderForm button.submit-btn:hover {
    background: #b00018;
  }

  /* Sipariş takip modal */
  #orderTrackContent p, #orderTrackContent ul {
    margin-bottom: 10px;
  }

  /* Footer */
  footer {
    background: #222;
    color:#ccc;
    padding: 20px;
    text-align: center;
    font-size: 0.9rem;
  }
  footer .contact-info {
    margin-bottom: 12px;
  }
  footer .admin-login button {
    background: #e60023;
    border:none;
    color:#fff;
    font-weight: 700;
    padding: 8px 15px;
    border-radius: 6px;
    font-size: 1rem;
  }
  footer .admin-login button:hover {
    background: #b00018;
  }
  /* Admin panel açma butonu */
  #adminPanelToggleBtn {
    background: #28a745;
    border:none;
    color:#fff;
    font-weight: 700;
    padding: 8px 15px;
    border-radius: 6px;
    font-size: 1rem;
    margin-top: 10px;
    cursor: pointer;
  }
  #adminPanelToggleBtn:hover {
    background: #1e7e34;
  }

  /* Admin panel */
  #adminPanel table {
    border-collapse: collapse;
    width: 100%;
    font-size: 0.9rem;
  }
  #adminPanel th, #adminPanel td {
    border: 1px solid #ddd;
    padding: 8px 10px;
  }
  #adminPanel th {
    background: #f7f7f7;
    font-weight: 700;
  }
  #adminPanel tr:nth-child(even) {
    background: #fafafa;
  }
  #adminPanel select {
    padding: 5px;
    font-size: 0.9rem;
  }

  /* Responsive */
  @media (max-width: 768px) {
    #productsContainer {
      justify-content: center;
    }
    .product-card {
      width: 45vw;
    }
    header {
      justify-content: space-between;
    }
  }
  @media (max-width: 480px) {
    .product-card {
      width: 90vw;
    }
  }
</style>
</head>
<body>

<header>
  <button id="orderTrackBtn" aria-label="Sipariş Takip">Sipariş Takip</button>
  <button id="cartBtn" aria-label="Sepetim">Sepet <span id="cartCount">(0)</span></button>
</header>

<main>
  <section id="productsContainer" aria-label="Ürün Listesi"></section>
</main>

<!-- Sepet Modal -->
<div class="modal-bg" id="cartModal" role="dialog" aria-modal="true" aria-labelledby="cartTitle">
  <div class="modal">
    <button class="close-btn" id="closeCart" aria-label="Sepeti Kapat">&times;</button>
    <h2 id="cartTitle">Sepetiniz</h2>
    <div id="cartItems"></div>
    <form id="orderForm" aria-label="Sipariş Formu">
      <label for="firstName">İsim *</label>
      <input type="text" id="firstName" name="firstName" required autocomplete="given-name" />
      <label for="lastName">Soyisim *</label>
      <input type="text" id="lastName" name="lastName" required autocomplete="family-name" />
      <label for="phone">Telefon (+90 ile başlar) *</label>
      <input type="tel" id="phone" name="phone" pattern="^\+90\d{10}$" placeholder="+905XXXXXXXXX" required autocomplete="tel" />
      <label for="note">Not (Opsiyonel)</label>
      <textarea id="note" name="note" rows="2" placeholder="Siparişle ilgili ek bilgi"></textarea>
      <label for="address">Adres *</label>
      <textarea id="address" name="address" rows="3" required placeholder="Adres bilgisi"></textarea>
      <label for="bankInfo">Banka / Kart Bilgileri *</label>
      <textarea id="bankInfo" name="bankInfo" rows="2" required placeholder="IBAN veya kart bilgisi"></textarea>
      <button type="submit" class="submit-btn" aria-label="Siparişi Onayla">Siparişi Onayla</button>
    </form>
  </div>
</div>

<!-- Sipariş Takip Modal -->
<div class="modal-bg" id="orderTrackModal" role="dialog" aria-modal="true" aria-labelledby="orderTrackTitle">
  <div class="modal">
    <button class="close-btn" id="closeOrderTrack" aria-label="Sipariş Takip Kapat">&times;</button>
    <h2 id="orderTrackTitle">Sipariş Takip</h2>
    <div id="orderTrackContent" tabindex="0"></div>
  </div>
</div>

<!-- Admin Giriş Modal -->
<div class="modal-bg" id="adminLoginModal" role="dialog" aria-modal="true" aria-labelledby="adminLoginTitle">
  <div class="modal">
    <button class="close-btn" id="closeAdminLogin" aria-label="Admin Giriş Kapat">&times;</button>
    <h2 id="adminLoginTitle">Admin Girişi</h2>
    <form id="adminLoginForm" aria-label="Admin Giriş Formu">
      <label for="adminUser">Kullanıcı Adı</label>
      <input type="text" id="adminUser" name="adminUser" autocomplete="username" required />
      <label for="adminPass">Şifre</label>
      <input type="password" id="adminPass" name="adminPass" autocomplete="current-password" required />
      <button type="submit" class="submit-btn">Giriş Yap</button>
    </form>
  </div>
</div>

<!-- Admin Panel Modal -->
<div class="modal-bg" id="adminPanelModal" role="dialog" aria-modal="true" aria-labelledby="adminPanelTitle">
  <div class="modal" style="max-width: 95vw; max-height: 95vh; overflow-y: auto;">
    <button class="close-btn" id="closeAdminPanel" aria-label="Admin Panel Kapat">&times;</button>
    <h2 id="adminPanelTitle">Admin Paneli</h2>
    <div id="adminPanel"></div>
  </div>
</div>

<footer>
  <div class="contact-info">
    <p>İletişim: info@mottotrend.com | Telefon: +90 555 123 4567</p>
  </div>
  <div class="admin-login">
    <button id="adminLoginBtn" aria-label="Admin Girişi">Admin Girişi</button>
    <button id="adminPanelToggleBtn" aria-label="Admin Paneli Aç">Admin Panel</button>
  </div>
</footer>

<script>
(() => {
  const ADMIN_USER = "admin";
  const ADMIN_PASS = "admin";
  const CART_KEY = "mottotrend_cart";
  const ORDERS_KEY = "mottotrend_orders";
  const USERS_KEY = "mottotrend_users";

  const products = [
    {id:1, title:"Erkek Beyaz Sneaker", price:199.90, img:"https://cdn.pixabay.com/photo/2016/11/29/03/53/sneakers-1866572_1280.jpg"},
    {id:2, title:"Kadın Siyah Deri Çanta", price:349.90, img:"https://cdn.pixabay.com/photo/2017/08/07/15/44/purse-2606722_1280.jpg"},
    {id:3, title:"Unisex Spor Saat", price:299.90, img:"https://cdn.pixabay.com/photo/2016/11/29/04/00/watch-1866594_1280.jpg"},
    {id:4, title:"Kahverengi Deri Cüzdan", price:89.90, img:"https://cdn.pixabay.com/photo/2018/10/03/16/08/wallet-3728590_1280.jpg"},
    {id:5, title:"Mavi Kot Pantolon", price:159.90, img:"https://cdn.pixabay.com/photo/2016/12/06/09/31/jeans-1889931_1280.jpg"},
    {id:6, title:"Siyah Basic Tişört", price:69.90, img:"https://cdn.pixabay.com/photo/2017/08/07/12/40/t-shirt-2606537_1280.jpg"},
    {id:7, title:"Güneş Gözlüğü Retro", price:139.90, img:"https://cdn.pixabay.com/photo/2017/08/07/14/33/sunglasses-2606614_1280.jpg"},
    {id:8, title:"Kadın Kırmızı Elbise", price:399.90, img:"https://cdn.pixabay.com/photo/2017/08/06/11/33/dress-2596057_1280.jpg"},
    {id:9, title:"Erkek Spor Ayakkabı", price:249.90, img:"https://cdn.pixabay.com/photo/2016/11/29/04/01/sneakers-1866597_1280.jpg"},
    {id:10, title:"Kadın Beyaz Bluz", price:179.90, img:"https://cdn.pixabay.com/photo/2016/03/27/22/21/blouse-1283143_1280.jpg"},
    {id:11, title:"Siyah Deri Bot", price:379.90, img:"https://cdn.pixabay.com/photo/2017/08/07/14/46/boots-2606623_1280.jpg"},
    {id:12, title:"Mavi Jean Ceket", price:289.90, img:"https://cdn.pixabay.com/photo/2017/08/07/12/46/jacket-2606543_1280.jpg"},
    {id:13, title:"Kadın Spor Çanta", price:199.90, img:"https://cdn.pixabay.com/photo/2017/08/07/15/20/bag-2606693_1280.jpg"},
    {id:14, title:"Erkek Şapka", price:79.90, img:"https://cdn.pixabay.com/photo/2017/08/07/14/33/hat-2606616_1280.jpg"},
    {id:15, title:"Kadın Sandalet", price:179.90, img:"https://cdn.pixabay.com/photo/2017/08/07/14/37/sandal-2606620_1280.jpg"},
    {id:16, title:"Unisex Sırt Çantası", price:249.90, img:"https://cdn.pixabay.com/photo/2017/08/07/15/40/backpack-2606710_1280.jpg"},
    {id:17, title:"Erkek Tişört Gri", price:89.90, img:"https://cdn.pixabay.com/photo/2017/08/07/12/39/t-shirt-2606534_1280.jpg"},
    {id:18, title:"Kadın Küpe", price:49.90, img:"https://cdn.pixabay.com/photo/2016/11/29/05/05/earrings-1866626_1280.jpg"},
    {id:19, title:"Erkek Kemer", price:99.90, img:"https://cdn.pixabay.com/photo/2017/08/07/14/00/belt-2606597_1280.jpg"},
    {id:20, title:"Kadın Ceket", price:299.90, img:"https://cdn.pixabay.com/photo/2017/08/07/12/44/jacket-2606541_1280.jpg"},
  ];

  // Sepet ve sipariş verileri
  let cart = JSON.parse(localStorage.getItem(CART_KEY)) || [];
  let orders = JSON.parse(localStorage.getItem(ORDERS_KEY)) || [];
  let users = JSON.parse(localStorage.getItem(USERS_KEY)) || [];

  // Admin login durumu
  let adminLoggedIn = false;

  // Elementler
  const productsContainer = document.getElementById("productsContainer");
  const cartBtn = document.getElementById("cartBtn");
  const cartCount = document.getElementById("cartCount");
  const cartModal = document.getElementById("cartModal");
  const closeCartBtn = document.getElementById("closeCart");
  const cartItemsContainer = document.getElementById("cartItems");
  const orderForm = document.getElementById("orderForm");

  const orderTrackBtn = document.getElementById("orderTrackBtn");
  const orderTrackModal = document.getElementById("orderTrackModal");
  const closeOrderTrackBtn = document.getElementById("closeOrderTrack");
  const orderTrackContent = document.getElementById("orderTrackContent");

  const adminLoginBtn = document.getElementById("adminLoginBtn");
  const adminLoginModal = document.getElementById("adminLoginModal");
  const closeAdminLoginBtn = document.getElementById("closeAdminLogin");
  const adminLoginForm = document.getElementById("adminLoginForm");

  const adminPanelModal = document.getElementById("adminPanelModal");
  const adminPanel = document.getElementById("adminPanel");
  const closeAdminPanelBtn = document.getElementById("closeAdminPanel");
  const adminPanelToggleBtn = document.getElementById("adminPanelToggleBtn");

  // Ürünleri göster
  function renderProducts() {
    productsContainer.innerHTML = "";
    products.forEach(p => {
      const div = document.createElement("div");
      div.className = "product-card";
      div.setAttribute("tabindex", "0");
      div.innerHTML = `
        <img src="${p.img}" alt="${p.title}" />
        <div class="product-info">
          <div class="product-title">${p.title}</div>
          <div class="product-price">${p.price.toFixed(2)}₺</div>
          <button class="add-cart-btn" data-id="${p.id}" aria-label="${p.title} sepete ekle">Sepete Ekle</button>
        </div>
      `;
      productsContainer.appendChild(div);
    });
  }

  // Sepet güncelleme sayacı
  function updateCartCount() {
    const totalQty = cart.reduce((acc, item) => acc + item.qty, 0);
    cartCount.textContent = `(${totalQty})`;
  }

  // Sepet modalını güncelle
  function renderCart() {
    if(cart.length === 0){
      cartItemsContainer.innerHTML = "<p>Sepetiniz boş.</p>";
      orderForm.style.display = "none";
      return;
    }
    orderForm.style.display = "block";
    let html = "";
    cart.forEach(item => {
      const product = products.find(p => p.id === item.id);
      html += `
        <div class="cart-item" tabindex="0">
          <img src="${product.img}" alt="${product.title}" />
          <div class="cart-item-info">
            <div class="cart-item-title">${product.title}</div>
            <div class="cart-item-qty">
              <button class="qty-minus" data-id="${item.id}" aria-label="Azalt">-</button>
              <span>${item.qty}</span>
              <button class="qty-plus" data-id="${item.id}" aria-label="Arttır">+</button>
            </div>
          </div>
          <button class="remove-btn" data-id="${item.id}" aria-label="Ürünü Sepetten Kaldır">&times;</button>
        </div>
      `;
    });
    cartItemsContainer.innerHTML = html;
  }

  // Sepete ürün ekle
  function addToCart(id) {
    const found = cart.find(item => item.id === id);
    if(found){
      found.qty++;
    } else {
      cart.push({id, qty: 1});
    }
    saveCart();
  }
  // Sepetten ürün azalt
  function decreaseQty(id) {
    const found = cart.find(item => item.id === id);
    if(found){
      if(found.qty > 1){
        found.qty--;
      } else {
        cart = cart.filter(item => item.id !== id);
      }
      saveCart();
    }
  }
  // Sepetten ürün kaldır
  function removeFromCart(id) {
    cart = cart.filter(item => item.id !== id);
    saveCart();
  }

  // LocalStorage kaydet
  function saveCart() {
    localStorage.setItem(CART_KEY, JSON.stringify(cart));
    updateCartCount();
    renderCart();
  }
  function saveOrders() {
    localStorage.setItem(ORDERS_KEY, JSON.stringify(orders));
  }
  function saveUsers() {
    localStorage.setItem(USERS_KEY, JSON.stringify(users));
  }

  // Sepet butonları ve ürün ekleme
  productsContainer.addEventListener("click", e => {
    if(e.target.classList.contains("add-cart-btn")){
      const id = parseInt(e.target.dataset.id);
      addToCart(id);
      alert("Ürün sepete eklendi.");
    }
  });

  // Sepet modal aç/kapa
  cartBtn.addEventListener("click", () => {
    renderCart();
    cartModal.classList.add("active");
  });
  closeCartBtn.addEventListener("click", () => {
    cartModal.classList.remove("active");
  });
  cartModal.addEventListener("click", e => {
    if(e.target === cartModal) cartModal.classList.remove("active");
  });

  // Sepet ürün miktar ve silme butonları
  cartItemsContainer.addEventListener("click", e => {
    if(e.target.classList.contains("qty-plus")){
      const id = parseInt(e.target.dataset.id);
      addToCart(id);
    } else if(e.target.classList.contains("qty-minus")){
      const id = parseInt(e.target.dataset.id);
      decreaseQty(id);
    } else if(e.target.classList.contains("remove-btn")){
      const id = parseInt(e.target.dataset.id);
      removeFromCart(id);
    }
  });

  // Sipariş form onayla
  orderForm.addEventListener("submit", e => {
    e.preventDefault();
    // Zorunlu alanları kontrol et
    const firstName = orderForm.firstName.value.trim();
    const lastName = orderForm.lastName.value.trim();
    const phone = orderForm.phone.value.trim();
    const note = orderForm.note.value.trim();
    const address = orderForm.address.value.trim();
    const bankInfo = orderForm.bankInfo.value.trim();

    if(!firstName || !lastName || !phone.match(/^\+90\d{10}$/) || !address || !bankInfo){
      alert("Lütfen zorunlu tüm alanları doğru doldurun.");
      return;
    }
    if(cart.length === 0){
      alert("Sepetiniz boş. Önce ürün ekleyin.");
      return;
    }
    // Kullanıcıyı kaydet ya da bul
    let user = users.find(u => u.phone === phone);
    if(!user){
      user = {
        id: Date.now(),
        firstName, lastName, phone, note, address, bankInfo,
        registerDate: new Date().toISOString()
      };
      users.push(user);
      saveUsers();
    } else {
      // Kullanıcı bilgilerini güncelle
      user.firstName = firstName;
      user.lastName = lastName;
      user.note = note;
      user.address = address;
      user.bankInfo = bankInfo;
      saveUsers();
    }
    // Siparişi kaydet
    const order = {
      id: Date.now(),
      userId: user.id,
      items: [...cart],
      status: "Sipariş Alındı",
      date: new Date().toISOString()
    };
    orders.push(order);
    saveOrders();

    // Sepeti temizle
    cart = [];
    saveCart();
    alert("Siparişiniz alındı, teşekkürler!");
    cartModal.classList.remove("active");
  });

  // Sipariş takip modal aç/kapa
  orderTrackBtn.addEventListener("click", () => {
    if(orders.length === 0){
      orderTrackContent.innerHTML = `<p>Henüz siparişiniz bulunmamaktadır. <a href="#">Alışverişe devam etmek için tıklayın.</a></p>`;
    } else {
      // Kullanıcıdan telefon iste
      orderTrackContent.innerHTML = `
        <label for="trackPhoneInput">Telefon Numaranızı (+90xxxxxxxxxx) Girin:</label>
        <input type="tel" id="trackPhoneInput" placeholder="+905xxxxxxxxx" pattern="^\\+90\\d{10}$" style="width:100%; padding:8px; margin-top:5px;" />
        <button id="trackSearchBtn" style="margin-top:10px; background:#e60023; color:#fff; border:none; padding:10px; border-radius:5px; font-weight:700;">Siparişi Bul</button>
        <div id="trackResult" style="margin-top:15px;"></div>
      `;
    }
    orderTrackModal.classList.add("active");
  });
  closeOrderTrackBtn.addEventListener("click", () => {
    orderTrackModal.classList.remove("active");
  });
  orderTrackModal.addEventListener("click", e => {
    if(e.target === orderTrackModal) orderTrackModal.classList.remove("active");
  });

  // Sipariş takip araması
  orderTrackContent.addEventListener("click", e => {
    if(e.target && e.target.id === "trackSearchBtn"){
      const input = document.getElementById("trackPhoneInput");
      const phone = input.value.trim();
      if(!phone.match(/^\+90\d{10}$/)){
        alert("Lütfen doğru telefon numarasını giriniz.");
        return;
      }
      const user = users.find(u => u.phone === phone);
      if(!user){
        document.getElementById("trackResult").innerHTML = "<p>Bu telefon numarasıyla kayıtlı sipariş bulunamadı.</p>";
        return;
      }
      // Kullanıcı siparişleri listelenir
      const userOrders = orders.filter(o => o.userId === user.id);
      if(userOrders.length === 0){
        document.getElementById("trackResult").innerHTML = "<p>Bu kullanıcıya ait sipariş bulunamadı.</p>";
        return;
      }
      let html = `<ul>`;
      userOrders.forEach(order => {
        html += `<li><strong>Sipariş Tarihi:</strong> ${new Date(order.date).toLocaleString()}<br/> <strong>Durum:</strong> ${order.status}<br/> <strong>Ürünler:</strong><ul>`;
        order.items.forEach(i => {
          const p = products.find(pr => pr.id === i.id);
          if(p) html += `<li>${p.title} (Adet: ${i.qty})</li>`;
        });
        html += `</ul></li><hr/>`;
      });
      html += `</ul>`;
      document.getElementById("trackResult").innerHTML = html;
    }
  });

  // Admin giriş modal aç/kapa
  adminLoginBtn.addEventListener("click", () => {
    adminLoginModal.classList.add("active");
  });
  closeAdminLoginBtn.addEventListener("click", () => {
    adminLoginModal.classList.remove("active");
  });
  adminLoginModal.addEventListener("click", e => {
    if(e.target === adminLoginModal) adminLoginModal.classList.remove("active");
  });

  // Admin giriş formu
  adminLoginForm.addEventListener("submit", e => {
    e.preventDefault();
    const username = adminLoginForm.adminUser.value.trim();
    const password = adminLoginForm.adminPass.value.trim();
    if(username === ADMIN_USER && password === ADMIN_PASS){
      adminLoggedIn = true;
      alert("Admin giriş başarılı!");
      adminLoginModal.classList.remove("active");
      showAdminPanel();
    } else {
      alert("Kullanıcı adı veya şifre yanlış!");
    }
  });

  // Admin panel aç/kapa
  adminPanelToggleBtn.addEventListener("click", () => {
    if(!adminLoggedIn){
      alert("Önce admin girişi yapmalısınız.");
      adminLoginModal.classList.add("active");
      return;
    }
    showAdminPanel();
  });
  closeAdminPanelBtn.addEventListener("click", () => {
    adminPanelModal.classList.remove("active");
  });
  adminPanelModal.addEventListener("click", e => {
    if(e.target === adminPanelModal) adminPanelModal.classList.remove("active");
  });

  // Admin panel fonksiyonu
  function showAdminPanel(){
    if(!adminLoggedIn) return;
    let html = `
      <table>
        <thead>
          <tr>
            <th>Kullanıcı Adı</th>
            <th>Telefon</th>
            <th>Kayıt Tarihi</th>
            <th>Adres</th>
            <th>Banka Bilgisi</th>
            <th>Siparişler</th>
          </tr>
        </thead>
        <tbody>
    `;
    users.forEach(user => {
      const userOrders = orders.filter(o => o.userId === user.id);
      html += `<tr>
        <td>${user.firstName} ${user.lastName}</td>
        <td>${user.phone}</td>
        <td>${new Date(user.registerDate).toLocaleString()}</td>
        <td>${user.address}</td>
        <td>${user.bankInfo}</td>
        <td>`;
      if(userOrders.length === 0){
        html += "Sipariş yok";
      } else {
        userOrders.forEach(order => {
          html += `
            <div style="border:1px solid #ddd; margin-bottom:8px; padding:6px; border-radius:5px;">
              <strong>Sipariş Tarihi:</strong> ${new Date(order.date).toLocaleString()}<br/>
              <strong>Durum:</strong> 
              <select data-orderid="${order.id}" class="status-select" aria-label="Sipariş Durum">
                <option value="Sipariş Alındı" ${order.status === "Sipariş Alındı" ? "selected" : ""}>Sipariş Alındı</option>
                <option value="Ürün Hazırlanıyor" ${order.status === "Ürün Hazırlanıyor" ? "selected" : ""}>Ürün Hazırlanıyor</option>
                <option value="Yola Çıktı" ${order.status === "Yola Çıktı" ? "selected" : ""}>Yola Çıktı</option>
                <option value="İptal Edildi" ${order.status === "İptal Edildi" ? "selected" : ""}>İptal Edildi</option>
              </select><br/>
              <strong>Ürünler:</strong>
              <ul>`;
          order.items.forEach(i => {
            const p = products.find(pr => pr.id === i.id);
            if(p) html += `<li>${p.title} (Adet: ${i.qty})</li>`;
          });
          html += "</ul></div>";
        });
      }
      html += "</td></tr>";
    });
    html += "</tbody></table>";
    adminPanel.innerHTML = html;

    adminPanelModal.classList.add("active");
  }

  // Admin panel sipariş durum değişimi
  adminPanel.addEventListener("change", e => {
    if(e.target.classList.contains("status-select")){
      const orderId = parseInt(e.target.dataset.orderid);
      const newStatus = e.target.value;
      const order = orders.find(o => o.id === orderId);
      if(order){
        order.status = newStatus;
        saveOrders();
        alert("Sipariş durumu güncellendi.");
      }
    }
  });

  // Başlangıçta ürünleri göster ve sayaç güncelle
  renderProducts();
  updateCartCount();

})();
</script>

</body>
</html>
