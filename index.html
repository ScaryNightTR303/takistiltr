<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HızlıAlış - Modern E-Ticaret</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0; padding: 0;
      background: #e3f2fd;
      color: #333;
    }
    header, footer {
      background: #1976d2;
      color: #fff;
      text-align: center;
      padding: 1.2em;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    nav a {
      margin: 0 15px;
      color: #fff;
      text-decoration: none;
      font-weight: 600;
      cursor: pointer;
      transition: color 0.3s ease;
    }
    nav a:hover {
      color: #ff9800;
    }
    .container {
      max-width: 960px;
      margin: 30px auto;
      background: #fff;
      padding: 25px 30px;
      border-radius: 10px;
      box-shadow: 0 10px 25px rgba(25, 118, 210, 0.15);
    }

    input[type=text], input[type=password], input[type=number], select, textarea {
      width: 100%;
      padding: 12px 15px;
      margin: 8px 0 15px 0;
      border: 1.5px solid #90caf9;
      border-radius: 6px;
      font-size: 16px;
      transition: border-color 0.3s ease;
      box-sizing: border-box;
    }
    input[type=text]:focus, input[type=password]:focus, input[type=number]:focus, select:focus, textarea:focus {
      border-color: #1976d2;
      outline: none;
    }
    button {
      background: #1976d2;
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 3px 10px rgba(25, 118, 210, 0.4);
      transition: background 0.3s ease, box-shadow 0.3s ease;
    }
    button:hover {
      background: #1565c0;
      box-shadow: 0 5px 15px rgba(21, 101, 192, 0.6);
    }

    /* Sipariş kutuları */
    .siparis-kutu {
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 15px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
      transition: box-shadow 0.3s ease;
      word-wrap: break-word;
    }
    .siparis-kutu:hover {
      box-shadow: 0 6px 18px rgba(0,0,0,0.15);
    }
    .aktif {
      background: #e3fcef;
      border-left: 5px solid #4caf50;
    }
    .gecmis {
      background: #ffe3e3;
      border-left: 5px solid #f44336;
    }

    /* Tablo */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
      font-size: 15px;
    }
    th, td {
      padding: 12px 10px;
      border-bottom: 1px solid #ddd;
      text-align: left;
      vertical-align: middle;
    }
    th {
      background-color: #2196f3;
      color: white;
    }

    /* Admin panel butonları */
    #adminSection button {
      background: #ff9800;
    }
    #adminSection button:hover {
      background: #fb8c00;
    }

    /* Responsive */
    @media (max-width: 600px) {
      .container {
        margin: 15px;
        padding: 15px;
      }
      nav a {
        display: block;
        margin: 8px 0;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>HızlıAlış</h1>
    <nav id="mainNav">
      <a onclick="showSection('loginSection')">Giriş Yap</a> | 
      <a onclick="showSection('registerSection')">Kayıt Ol</a>
      <a id="adminPanelLink" class="hidden" onclick="showSection('adminSection')">Admin Paneli</a>
    </nav>
  </header>

  <div class="container">
    <!-- Giriş -->
    <section id="loginSection">
      <h2>Giriş Yap</h2>
      <input type="text" id="loginUsername" placeholder="Kullanıcı Adı" />
      <input type="password" id="loginPassword" placeholder="Şifre" />
      <button onclick="login()">Giriş</button>
      <p id="loginMsg" style="color:red;"></p>
    </section>

    <!-- Kayıt -->
    <section id="registerSection" class="hidden">
      <h2>Kayıt Ol</h2>
      <input type="text" id="registerUsername" placeholder="Kullanıcı Adı" />
      <input type="password" id="registerPassword" placeholder="Şifre" />
      <input type="text" id="registerAddress" placeholder="Adres" />
      <button onclick="register()">Kayıt Ol</button>
      <p id="registerMsg" style="color:red;"></p>
    </section>

    <!-- Kullanıcı Paneli -->
    <section id="userSection" class="hidden">
      <h2>Kullanıcı Paneli</h2>
      <p>Hoşgeldiniz, <b><span id="userNameDisplay"></span></b> | <button onclick="logout()">Çıkış Yap</button></p>
      <div id="balanceDisplay" style="font-size:18px; margin-bottom:20px;"></div>

      <h3>Sipariş Ver</h3>
      <select id="urunSec">
        <option value="Telefon" data-fiyat="15000">Telefon - 15,000 TL</option>
        <option value="Kulaklık" data-fiyat="500">Kulaklık - 500 TL</option>
        <option value="Klavye" data-fiyat="1000">Klavye - 1,000 TL</option>
        <option value="Mouse" data-fiyat="700">Mouse - 700 TL</option>
        <option value="Monitör" data-fiyat="4500">Monitör - 4,500 TL</option>
        <option value="USB Bellek" data-fiyat="150">USB Bellek - 150 TL</option>
        <option value="Powerbank" data-fiyat="800">Powerbank - 800 TL</option>
        <option value="Web Kamera" data-fiyat="1200">Web Kamera - 1,200 TL</option>
        <option value="Hoparlör" data-fiyat="950">Hoparlör - 950 TL</option>
        <option value="Tablet" data-fiyat="9000">Tablet - 9,000 TL</option>
      </select>
      <input type="number" id="siparisAdet" placeholder="Adet" value="1" min="1" />
      <button onclick="siparisOlustur()">Sipariş Oluştur</button>

      <h3>Siparişlerim</h3>
      <div id="aktifSiparisler"><h4>Aktif Siparişler</h4><div id="aktifListesi"></div></div>
      <div id="gecmisSiparisler"><h4>Geçmiş Siparişler</h4><div id="gecmisListesi"></div></div>
    </section>

    <!-- Admin Paneli -->
    <section id="adminSection" class="hidden">
      <h2>Admin Paneli</h2>
      <p>Hoşgeldiniz, Admin | <button onclick="logout()">Çıkış Yap</button></p>

      <h3>Kullanıcılar</h3>
      <table id="usersTable">
        <thead>
          <tr><th>Kullanıcı</th><th>Bakiye (TL)</th><th>Adres</th><th>İşlemler</th></tr>
        </thead>
        <tbody></tbody>
      </table>

      <h3>Seçili Kullanıcının Siparişleri: <span id="selectedUser"></span></h3>
      <div id="adminSiparisListesi"></div>
    </section>
  </div>

  <footer>
    <p>&copy; 2025 HızlıAlış</p>
  </footer>

  <script>
    // Başlangıç verileri ve localStorage yükleme
    let users = JSON.parse(localStorage.getItem('users')) || { "admin": "admin1212" };
    let bakiyeler = JSON.parse(localStorage.getItem('bakiyeler')) || { "admin": 0 };
    let adresler = JSON.parse(localStorage.getItem('adresler')) || { "admin": "" };
    let siparisler = JSON.parse(localStorage.getItem('siparisler')) || { "admin": [] };
    let siparisDurumlari = JSON.parse(localStorage.getItem('siparisDurumlari')) || { "admin": [] };

    let aktifKullanici = null;
    let seciliKullaniciAdmin = null;

    function kaydetVeri() {
      localStorage.setItem('users', JSON.stringify(users));
      localStorage.setItem('bakiyeler', JSON.stringify(bakiyeler));
      localStorage.setItem('adresler', JSON.stringify(adresler));
      localStorage.setItem('siparisler', JSON.stringify(siparisler));
      localStorage.setItem('siparisDurumlari', JSON.stringify(siparisDurumlari));
    }

    function showSection(id) {
      ['loginSection', 'registerSection', 'userSection', 'adminSection'].forEach(s => {
        document.getElementById(s).classList.add('hidden');
      });
      document.getElementById(id).classList.remove('hidden');
    }

    function updateNav() {
      const adminLink = document.getElementById('adminPanelLink');
      const nav = document.getElementById('mainNav');
      if (aktifKullanici === 'admin') {
        adminLink.classList.remove('hidden');
        [...nav.querySelectorAll('a')].forEach(a => {
          if (a !== adminLink) a.style.display = 'none';
        });
      } else if (aktifKullanici) {
        adminLink.classList.add('hidden');
        [...nav.querySelectorAll('a')].forEach(a => {
          if (a.textContent === 'Giriş Yap' || a.textContent === 'Kayıt Ol') {
            a.style.display = 'none';
          } else {
            a.style.display = '';
          }
        });
      } else {
        adminLink.classList.add('hidden');
        [...nav.querySelectorAll('a')].forEach(a => a.style.display = '');
      }
    }

    function register() {
      const u = document.getElementById('registerUsername').value.trim();
      const p = document.getElementById('registerPassword').value.trim();
      const a = document.getElementById('registerAddress').value.trim();
      const msg = document.getElementById('registerMsg');
      if (!u || !p || !a) {
        msg.style.color = "red";
        msg.textContent = "Tüm alanları doldurun.";
        return;
      }
      if (users[u]) {
        msg.style.color = "red";
        msg.textContent = "Bu kullanıcı zaten var.";
        return;
      }
      users[u] = p;
      bakiyeler[u] = 10000; // Yeni kullanıcıya başlangıç bakiyesi
      adresler[u] = a;
      siparisler[u] = [];
      siparisDurumlari[u] = [];
      kaydetVeri();
      msg.style.color = "green";
      msg.textContent = "Kayıt başarılı! Giriş yapabilirsiniz.";
      setTimeout(() => {
        msg.textContent = "";
        showSection('loginSection');
      }, 2000);
    }

    function login() {
      const u = document.getElementById('loginUsername').value.trim();
      const p = document.getElementById('loginPassword').value.trim();
      const msg = document.getElementById('loginMsg');
      if (users[u] && users[u] === p) {
        aktifKullanici = u;
        msg.textContent = "";
        updateNav();
        document.getElementById('userNameDisplay').textContent = u;
        bakiyeGoster();
        siparisleriGoster();
        showSection('userSection');
      } else {
        msg.style.color = "red";
        msg.textContent = "Kullanıcı adı veya şifre yanlış.";
      }
    }

    function logout() {
      aktifKullanici = null;
      seciliKullaniciAdmin = null;
      updateNav();
      showSection('loginSection');
      document.getElementById('loginUsername').value = '';
      document.getElementById('loginPassword').value = '';
      document.getElementById('loginMsg').textContent = '';
      document.getElementById('registerUsername').value = '';
      document.getElementById('registerPassword').value = '';
      document.getElementById('registerAddress').value = '';
      document.getElementById('registerMsg').textContent = '';
    }

    function bakiyeGoster() {
      document.getElementById('balanceDisplay').textContent = "Bakiyeniz: " + bakiyeler[aktifKullanici] + " TL";
    }

    function siparisOlustur() {
      const urun = document.getElementById('urunSec').value;
      const adet = parseInt(document.getElementById('siparisAdet').value);
      if (adet < 1 || isNaN(adet)) return alert("Lütfen geçerli bir adet girin.");
      const fiyat = parseInt(document.getElementById('urunSec').selectedOptions[0].dataset.fiyat);
      const toplam = adet * fiyat;
      if (bakiyeler[aktifKullanici] < toplam) return alert("Yetersiz bakiye!");
      bakiyeler[aktifKullanici] -= toplam;
      if (!siparisler[aktifKullanici]) siparisler[aktifKullanici] = [];
      if (!siparisDurumlari[aktifKullanici]) siparisDurumlari[aktifKullanici] = [];
      siparisler[aktifKullanici].push(urun + " x" + adet + " (" + toplam + " TL)");
      siparisDurumlari[aktifKullanici].push("Sipariş Alındı");
      kaydetVeri();
      bakiyeGoster();
      siparisleriGoster();
      alert("Siparişiniz oluşturuldu. Kalan bakiyeniz: " + bakiyeler[aktifKullanici] + " TL");
    }

    function siparisleriGoster() {
      const aktifDiv = document.getElementById('aktifListesi');
      const gecmisDiv = document.getElementById('gecmisListesi');
      aktifDiv.innerHTML = "";
      gecmisDiv.innerHTML = "";
      const sList = siparisler[aktifKullanici] || [];
      const dList = siparisDurumlari[aktifKullanici] || [];
      sList.forEach((siparis, i) => {
        const durum = dList[i];
        const el = document.createElement("div");
        el.className = "siparis-kutu " + (durum === "Teslim Edildi" ? "gecmis" : "aktif");
        el.textContent = siparis + " | Durum: " + durum;
        if (durum === "Teslim Edildi") {
          gecmisDiv.appendChild(el);
        } else {
          aktifDiv.appendChild(el);
        }
      });
    }

    // Admin paneli fonksiyonları
    function adminPanelGoster() {
      const tbody = document.querySelector("#usersTable tbody");
      tbody.innerHTML = "";
      Object.keys(users).forEach(u => {
        if (u === "admin") return;
        const tr = document.createElement("tr");

        const tdUser = document.createElement("td");
        tdUser.textContent = u;

        const tdBakiye = document.createElement("td");
        const bakiyeInput = document.createElement("input");
        bakiyeInput.type = "number";
        bakiyeInput.value = bakiyeler[u] || 0;
        bakiyeInput.style.width = "80px";
        bakiyeInput.onchange = () => {
          const val = parseFloat(bakiyeInput.value);
          if (!isNaN(val)) {
            bakiyeler[u] = val;
            kaydetVeri();
          }
        };
        tdBakiye.appendChild(bakiyeInput);

        const tdAdres = document.createElement("td");
        tdAdres.textContent = adresler[u] || "";

        const tdIslemler = document.createElement("td");
        const btnSiparisler = document.createElement("button");
        btnSiparisler.textContent = "Siparişleri Gör";
        btnSiparisler.onclick = () => {
          seciliKullaniciAdmin = u;
          document.getElementById("selectedUser").textContent = u;
          adminSiparisleriGoster(u);
        };
        tdIslemler.appendChild(btnSiparisler);

        tr.appendChild(tdUser);
        tr.appendChild(tdBakiye);
        tr.appendChild(tdAdres);
        tr.appendChild(tdIslemler);
        tbody.appendChild(tr);
      });
    }

    function adminSiparisleriGoster(kullanici) {
      const container = document.getElementById("adminSiparisListesi");
      container.innerHTML = "";
      const sList = siparisler[kullanici] || [];
      const dList = siparisDurumlari[kullanici] || [];
      sList.forEach((siparis, i) => {
        const div = document.createElement("div");
        div.className = "siparis-kutu " + (dList[i] === "Teslim Edildi" ? "gecmis" : "aktif");
        div.style.marginBottom = "12px";

        const pDetay = document.createElement("p");
        pDetay.textContent = siparis;

        const durumSelect = document.createElement("select");
        ["Sipariş Alındı", "Hazırlanıyor", "Kargoda", "Teslim Edildi", "İptal Edildi"].forEach(durum => {
          const opt = document.createElement("option");
          opt.value = durum;
          opt.textContent = durum;
          if (durum === dList[i]) opt.selected = true;
          durumSelect.appendChild(opt);
        });

        durumSelect.onchange = () => {
          siparisDurumlari[kullanici][i] = durumSelect.value;
          kaydetVeri();
          adminSiparisleriGoster(kullanici);
        };

        div.appendChild(pDetay);
        div.appendChild(durumSelect);
        container.appendChild(div);
      });
    }

    // Sayfa yüklendiğinde admin paneli hazırla
    window.onload = () => {
      if (!users["admin"]) {
        users["admin"] = "admin1212";
        bakiyeler["admin"] = 0;
        adresler["admin"] = "";
        siparisler["admin"] = [];
        siparisDurumlari["admin"] = [];
        kaydetVeri();
      }
      updateNav();
    };

    // Admin panel linki tıklanınca
    document.getElementById("adminPanelLink").onclick = () => {
      showSection("adminSection");
      adminPanelGoster();
    };
  </script>
</body>
</html>
